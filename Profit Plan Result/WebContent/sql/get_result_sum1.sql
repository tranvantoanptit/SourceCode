DROP TABLE IF EXISTS tmp;
SELECT '"' || expensecode || ':' || expensename || '"' as Expense, '"' || targetyearmonth || '"' as targetyearmonth, sum(expensevalue) AS result_sum INTO TEMP TABLE tmp FROM result WHERE orgcode IN ('84A00000','84A03100','84A03700','84A03800','84A03900','84A31111','84A31112','84A31121','84A31122','84A31131','84A31132','84A31140','84A31151','84A31152','84A32111','84A32112','84A32113','84A32114','84A32115','84A32121','84A32122','84A32123','84A32211','84A32212','84A32213','84A32214','84A32215','84A32216','84A32217','84A32221','84A32222','84A32223','84A32224','84A32225','84A32231','84A32232','84A32233','84A32234','84A32235','84A32241','84A32242','84A32311','84A32312','84A35111','84A35112','84A35121','84A35122','84A35123','84A35211','84A35221','84A35222','84A35231','84A37111','84A37121','84A37122','84A37123','84A37130','84A37141','84A37142','84A37151','84A37152','84A39110','84A41110','84A41120','84A41210','84A41220','84A41230','84A41310','84A41320','84A42110','84A42120','84A42210','84A45110','84A45120','84A45130','84A45210','84A45220','84A47110','84A47210','84A47220','84A47310','84A09510','84A51110','84A51120','84A51130','84A09520','84A52110','84A52120','84A52130','84A09500','84A61110','84A61130','84A61210','84A61220','84A09100','84A19100','84A89100') AND expensecode IN ('2140') AND makedate IN (SELECT DISTINCT max(makedate) FROM result WHERE targetyearmonth BETWEEN '2016/04' AND '2016/07' GROUP BY targetyearmonth, orgcode ORDER BY 1 ASC) GROUP BY 1,2 ORDER BY 1,2 ASC;
SELECT pivotcode('tmp','Expense','targetyearmonth','result_sum','numeric');
SELECT pivotcode('tmp','targetyearmonth','Expense','result_sum','numeric');